<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>トレーニングデータ取得</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        #stopwatch { font-size: 20px; }
        #start, #reset { padding: 5px 15px; }
    </style>
</head>
<body>
    <h1>1.トレーニングデータ取得</h1>
    <h2>・マル1回目</h2>
    <div>
        <h2>①データ取得</h2>
        <!-- スタートとリセットボタン -->
        <button id="start">スタート</button>
        <button id="reset">やり直し</button>
        <div id="stopwatch">0 秒</div>
    </div>
    <div>
        <h2>②閾値設定</h2>
        <!-- スライダーで閾値を設定 -->
        <input type="range" id="threshold" name="threshold" min="0" max="5" step="0.1" value="1">
        <span id="threshold-value">閾値: 1</span>
    </div>
    <div>
        <!-- 加速度データのグラフ -->
        <img id="graph-image" src="" alt="加速度データのグラフ">
    </div>

    <script>
        $(document).ready(function() {
            var intervalId, counter = 0;

            // スタートボタンをクリックした時の処理
            $('#start').click(function() {
                clearInterval(intervalId);
                intervalId = setInterval(function() {
                    counter++;
                    if (counter > 2) { // 2秒で停止
                        clearInterval(intervalId);
                    }
                    $('#stopwatch').text(counter + ' 秒');
                }, 1000);
            });

            // リセットボタンをクリックした時の処理
            $('#reset').click(function() {
                clearInterval(intervalId);
                counter = 0;
                $('#stopwatch').text(counter + ' 秒');
            });

            // スライダーの値が変わるたびにイベントをトリガーする
            $('#threshold').on('input', function() {
                var threshold = $(this).val();
                $('#threshold-value').text('閾値: ' + threshold);

                // グラフを更新するためのPOSTリクエストを送信
                $.post('/update_graph', {threshold: threshold}, function(data) {
                    // グラフの画像を更新
                    $('#graph-image').attr('src', data.image_url);
                });
            });
        });
    </script>
</body>
</html>
